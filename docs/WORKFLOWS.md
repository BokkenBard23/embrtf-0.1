## Рабочие процессы

### 1) Подготовка данных
- Создайте тематические папки в `Input/` и загрузите `.rtf`.
- Имена файлов могут содержать метаданные: `YYYYMMDDhhmmss_<login>_<clientNumber>.rtf` — распознаётся оператор и номер клиента.

### 2) Обработка (pipeline)
Команда:
```bash
python pipeline.py
```
Что происходит:
- Инициализация БД (таблицы `dialogs`, `utterances`, `utterance_embeddings`).
- Парсинг RTF → извлечение реплик вида `Speaker: text [HH:MM:SS]`.
- Сохранение диалогов и реплик.
- Пакетное кодирование реплик `SentenceTransformer` с учётом памяти (динамический batch, TF32).
- Сохранение эмбеддингов в `utterance_embeddings`.
- Перемещение обработанных файлов в `processed/<Тема>`.

### 3) Индексация (indexer)
Команда:
```bash
python indexer.py
```
Что происходит:
- Чтение эмбеддингов из БД и построение FAISS-индексов по темам + общий `all`.
- L2-нормализация и сохранение индексов на диск (`faiss_index/*.index`) + `ids_*.json`.
- Запись метаданных индексов в БД (`faiss_indexes`).

### 4) Аналитика/поиск (GUI)
Команда:
```bash
python gui.py
```
Функции:
- Поиск ближайших реплик по выбранной теме.
- Просмотр ближайшего контекста из диалога.
- Выбор метода анализа из `analysis_methods.py` и генерация ответа.
- Экспорт ответа и найденного контекста в `.txt`.

### 5) Переиндексация
- При добавлении новых файлов повторите шаги 2 и 3. GUI подхватит новые индексы при следующем запуске.


